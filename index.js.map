{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '23727869-9ab5af5c09b745cc02503bdaa';\n\nexport async function getImage(userInput, page) {\n  const params = {\n    key: API_KEY,\n    q: userInput,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: 40,\n  };\n  try {\n    const res = await axios.get(BASE_URL, { params });\n    return res.data;\n  } catch (err) {\n    console.error(err.message);\n    throw err;\n  }\n}\n","import { refs } from '../main.js';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nfunction imageTemplate(image) {\n  return ` <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img\n            class=\"card-image\"\n            src=\"${image.webformatURL}\"\n            alt=\"${image.tags}\"\n          />\n          <div class=\"card-descr\">\n            <div class=\"card-descr-elem\">\n              <p class=\"elem-titel\">Likes</p>\n              <p class=\"elem-value\">${image.likes}</p>\n            </div>\n\n            <div class=\"card-descr-elem\">\n              <p class=\"elem-titel\">Views</p>\n              <p class=\"elem-value\">${image.views}</p>\n            </div>\n\n            <div class=\"card-descr-elem\">\n              <p class=\"elem-titel\">Comments</p>\n              <p class=\"elem-value\">${image.comments}</p>\n            </div>\n\n            <div class=\"card-descr-elem\">\n              <p class=\"elem-titel\">Downloads</p>\n              <p class=\"elem-value\">${image.downloads}</p>\n            </div>\n          </div>\n        </a>\n      </li>`;\n}\n\nexport function renderGallery(images) {\n  const markup = images.map(imageTemplate).join('');\n  refs.gallery.innerHTML = markup;\n  lightbox.refresh();\n}\n\nexport function addRenderGallery(images) {\n  const markup = images.map(imageTemplate).join('');\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImage } from './js/pixabay-api';\nimport { renderGallery, addRenderGallery } from './js/render-functions.js';\n\nconst iziToastOptions = {\n  messageColor: '#FAFAFB',\n  messageSize: '16px',\n  color: '#EF4040',\n  transitionIn: 'bounceInLeft',\n  position: 'topRight',\n  displayMode: 'replace',\n  closeOnClick: true,\n};\n\nconst showErrorMessage = message => {\n  iziToast.show({\n    ...iziToastOptions,\n    message,\n  });\n};\n\nexport const refs = {\n  form: document.querySelector('.form'),\n  btn: document.querySelector('.form-button'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.load-btn'),\n};\n\n//============================================================\n\nconst params = {\n  q: null,\n  page: 1,\n  total: null,\n};\n\n//============================================================\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n  refs.gallery.innerHTML = '';\n\n  showLoader();\n\n  params.q = e.target.elements.image.value.trim();\n  params.page = 1;\n\n  if (!params.q) {\n    refs.gallery.innerHTML = '';\n    hideLoader();\n    showErrorMessage('Please enter a search term!');\n    hideLoadMoreBtn();\n    return;\n  }\n  try {\n    const images = await getImage(params.q, params.page);\n    if (images.hits.length === 0) {\n      hideLoader();\n      showErrorMessage('No images found. Try a different search');\n      return;\n    }\n    renderGallery(images.hits);\n    params.total = images.totalHits;\n    checkPageStatus();\n  } catch (err) {\n    showErrorMessage('Oops! Something went wrong');\n    console.error(err);\n  }\n\n  hideLoader();\n});\n\n//======================= BUTTON LOAD MORE ===========================\n\nrefs.btnLoadMore.addEventListener('click', async () => {\n  params.page += 1;\n  showLoader();\n  try {\n    const images = await getImage(params.q, params.page);\n    addRenderGallery(images.hits);\n    checkPageStatus();\n    scrollPage();\n  } catch (err) {\n    showErrorMessage('Oops! Something went wrong');\n    console.error(err);\n  }\n  hideLoader();\n});\n\n//======================= SHOW-HIDE ==========================\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\nfunction showLoadMoreBtn() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\nfunction hideLoadMoreBtn() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\nfunction checkPageStatus() {\n  const perPage = 40;\n  const maxPage = Math.ceil(params.total / perPage);\n\n  if (params.page >= maxPage) {\n    hideLoadMoreBtn();\n    showErrorMessage('It seems you have reached the end');\n  } else {\n    showLoadMoreBtn();\n  }\n}\n\nfunction scrollPage() {\n  let elem = refs.gallery.firstElementChild;\n  let rect = elem.getBoundingClientRect();\n  let height = rect.height;\n\n  scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\n//=================================================\n// function getCardHight() {\n//   let elem = refs.gallery.firstElementChild;\n//   let rect = elem.getBoundingClientRect();\n//   return rect.height * 2;\n// }\n\n// let elem = document.querySelector('div');\n// let rect = elem.getBoundingClientRect();\n// for (const key in rect) {\n//   if (typeof rect[key] !== 'function') {\n//     let para = document.createElement('p');\n//     para.textContent = `${key} : ${rect[key]}`;\n//     document.body.appendChild(para);\n//   }\n// }\n\n// window.scrollBy({\n//   top: 100,\n//   left: 100,\n//   behavior: 'smooth',\n// });\n"],"names":["BASE_URL","API_KEY","getImage","userInput","page","params","axios","err","lightbox","SimpleLightbox","imageTemplate","image","renderGallery","images","markup","refs","addRenderGallery","iziToastOptions","showErrorMessage","message","iziToast","showLoader","hideLoader","hideLoadMoreBtn","checkPageStatus","scrollPage","showLoadMoreBtn","maxPage","height"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAET,eAAeC,EAASC,EAAWC,EAAM,CAC9C,MAAMC,EAAS,CACb,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAU,EACd,EACE,GAAI,CAEF,OADY,MAAME,EAAM,IAAIN,EAAU,CAAE,OAAAK,CAAM,CAAE,GACrC,IACZ,OAAQE,EAAK,CACZ,cAAQ,MAAMA,EAAI,OAAO,EACnBA,CACP,CACH,CCjBA,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,SAAU,GACV,aAAc,MACd,aAAc,IACd,eAAgB,EAClB,CAAC,EAED,SAASC,EAAcC,EAAO,CAC5B,MAAO;AAAA,wCAC+BA,EAAM,aAAa;AAAA;AAAA;AAAA,mBAGxCA,EAAM,YAAY;AAAA,mBAClBA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,sCAKSA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,sCAKXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,sCAKXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,sCAKdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,YAKrD,CAEO,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EAAO,IAAIH,CAAa,EAAE,KAAK,EAAE,EAChDK,EAAK,QAAQ,UAAYD,EACzBN,EAAS,QAAO,CAClB,CAEO,SAASQ,EAAiBH,EAAQ,CACvC,MAAMC,EAASD,EAAO,IAAIH,CAAa,EAAE,KAAK,EAAE,EAChDK,EAAK,QAAQ,mBAAmB,YAAaD,CAAM,EACnDN,EAAS,QAAO,CAClB,CClDA,MAAMS,EAAkB,CACtB,aAAc,UACd,YAAa,OACb,MAAO,UACP,aAAc,eACd,SAAU,WACV,YAAa,UACb,aAAc,EAChB,EAEMC,EAAmBC,GAAW,CAClCC,EAAS,KAAK,CACZ,GAAGH,EACH,QAAAE,CACJ,CAAG,CACH,EAEaJ,EAAO,CAClB,KAAM,SAAS,cAAc,OAAO,EACpC,IAAK,SAAS,cAAc,cAAc,EAC1C,QAAS,SAAS,cAAc,UAAU,EAC1C,OAAQ,SAAS,cAAc,SAAS,EACxC,YAAa,SAAS,cAAc,WAAW,CACjD,EAIMV,EAAS,CACb,EAAG,KACH,KAAM,EACN,MAAO,IACT,EAIAU,EAAK,KAAK,iBAAiB,SAAU,MAAM,GAAK,CAS9C,GARA,EAAE,eAAc,EAChBA,EAAK,QAAQ,UAAY,GAEzBM,IAEAhB,EAAO,EAAI,EAAE,OAAO,SAAS,MAAM,MAAM,OACzCA,EAAO,KAAO,EAEV,CAACA,EAAO,EAAG,CACbU,EAAK,QAAQ,UAAY,GACzBO,IACAJ,EAAiB,6BAA6B,EAC9CK,IACA,MACD,CACD,GAAI,CACF,MAAMV,EAAS,MAAMX,EAASG,EAAO,EAAGA,EAAO,IAAI,EACnD,GAAIQ,EAAO,KAAK,SAAW,EAAG,CAC5BS,IACAJ,EAAiB,yCAAyC,EAC1D,MACD,CACDN,EAAcC,EAAO,IAAI,EACzBR,EAAO,MAAQQ,EAAO,UACtBW,GACD,OAAQjB,EAAK,CACZW,EAAiB,4BAA4B,EAC7C,QAAQ,MAAMX,CAAG,CAClB,CAEDe,GACF,CAAC,EAIDP,EAAK,YAAY,iBAAiB,QAAS,SAAY,CACrDV,EAAO,MAAQ,EACfgB,IACA,GAAI,CACF,MAAMR,EAAS,MAAMX,EAASG,EAAO,EAAGA,EAAO,IAAI,EACnDW,EAAiBH,EAAO,IAAI,EAC5BW,IACAC,GACD,OAAQlB,EAAK,CACZW,EAAiB,4BAA4B,EAC7C,QAAQ,MAAMX,CAAG,CAClB,CACDe,GACF,CAAC,EAID,SAASD,GAAa,CACpBN,EAAK,OAAO,UAAU,OAAO,QAAQ,CACvC,CACA,SAASO,GAAa,CACpBP,EAAK,OAAO,UAAU,IAAI,QAAQ,CACpC,CAEA,SAASW,GAAkB,CACzBX,EAAK,YAAY,UAAU,OAAO,QAAQ,CAC5C,CACA,SAASQ,GAAkB,CACzBR,EAAK,YAAY,UAAU,IAAI,QAAQ,CACzC,CAEA,SAASS,GAAkB,CAEzB,MAAMG,EAAU,KAAK,KAAKtB,EAAO,MAAQ,EAAO,EAE5CA,EAAO,MAAQsB,GACjBJ,IACAL,EAAiB,mCAAmC,GAEpDQ,GAEJ,CAEA,SAASD,GAAa,CAGpB,IAAIG,EAFOb,EAAK,QAAQ,kBACR,wBACE,OAElB,SAAS,CACP,IAAKa,EAAS,EACd,SAAU,QACd,CAAG,CACH"}